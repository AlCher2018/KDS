История изменений приложения KDSWPFClient.exe - кухонный дисплей
================================================================

Версия 2.0.0.3
--------------
2017-09-27 Для устранения "висячих" заголовков заказа (в одной колонке вверху заголовок, в другой - строки заказа) изменена процедура рассчета координат панелей заказов. Этот баг должен уйти, но надо понаблюдать. Заодно, более корректно используются граничные отступы на панели заказов и вертикальный отступ панелей заказов друг от друга.
Легенду цветов таймеров теперь можно закрыть, кликнув в любом месте экрана, а не только по самой легенде.
Немного изменена логика определения ингредиентов в таблице OrderDish: ранее признаком ингредиента было наличие Uid родителя в полях UID и ParentUid проверяемой строки. Сейчас проверяется только поле ParentUid.
Некоторые настройки размещения заказов на экране вынесены в раздел <appSettings> config-файла для возможности клиентской настройки:
 - "OrdersPanelTopBotMargin" - отступ сверху/снизу для панели заказов, в пикселях (по умолчанию 40);
 - "OrderPanelTopMargin" - отступ между заказами по вертикали, в пикселях (по умолчанию 50);
 - "OrderPanelLeftMargin" - отступ между заказами по горизонтали, в долях от ширины панели заказа (по умолчанию 0.15);
 - "OrdersPanelScrollButtonSize" - кнопки прокрутки страниц, в пикселях (по умолчанию 100).
 2017-09-29 Устранен баг проверки наличия psw-файла, при котором на экране отображалось сообщение об отсутствии этого файла без ключа. Теперь и при отсутствии psw-файла, и при неверном psw-файле, в лог записывается ключ, который необходимо передать обслуживающей компании для генерации правильного ключа.


2017-09-08 Внесены изменения в config-файл: раздел
    <targets>
      <target name="fileTrace" xsi:type="File" fileName="Logs/KDSClient.log" layout="${date}|${level}|${message}"/>
    </targets>
заменен полностью разделом
    <targets async="true">
      <target name="fileTrace" xsi:type="File" fileName="Logs/KDSClient.log" layout="${date}|${level}|${message}"
              archiveEvery = "Hour" archiveFileName = "Logs/KDSClient {#}.txt" archiveNumbering = "Date" archiveDateFormat="yyyyMMdd HH\h"
              concurrentWrites="false" keepFileOpen="true"/>
    </targets>
Эти изменения позволяют:
- делать записи в лог асинхронно;
- держать файл журнала постоянно открытым;
- каждый час сбрасывать журнал в архив (т.е. за сутки будет 24 файла), уменьшая таким образом файл журнала.


Версия 2.0.0.2
--------------
2017-09-07 Устранен баг, когда приложение запускалось НЕ из папки приложения, файл e_init.psw не обнаруживался в текущем каталоге и приложение не стартовало. Теперь при старте приложения проверяется текущий каталог и, если надо, устанавливается на папку приложения, в лог производится соответствующая запись.


Версия 2.0.0.1
--------------
2017-08-30 Изменена работа с логированием:
- в NLog (раздел config-файла) удален журнал dbCommandTracer (fileName="Logs/KDSDBCommands.log"), все сообщения будут писаться в один файл Logs/KDSService.log, из config-файла удален элемент SingleClientSvcLog;
- элемент IsLogUserAction переименован в IsLogClientAction;
- настройки логирования перенесены из файла NLog.config в секцию nlog config-файла приложения.
Все логируемые события разделены на три категории: стандартные, детальные и пользовательские действия.
1. Стандартные события - начало/окончание работы приложения (системное окружение, настройка), сообщения о критических ошибках.
2. Детальные события - обработка списка заказов, периодически получаемых от службы: фильтрация и сортировка для конкретного клиента, согласно настроек из config-файла, перерисовка заказов на экране.
3. Действия пользователя - обычно клики по различным элементам управления на экране в рамках бизнес-процессов: пункты заказа, заголовок заказа, выбор в окне изменения статуса, запрос к службе на изменение статуса пункта или всего заказа, изменение конфигурации в окне настроек, фильтрация и группировка заказов боковыми кнопками.
Для включения/отключения логирования каждой категории событий, в config-файле имеются соответствующие элементы: 
 - IsWriteTraceMessages - стандартные события;
 - TraceOrdersDetails - детальные события;
 - IsLogClientAction - пользовательские действия.


Версия 2.0.0.0
--------------
2017-08-10 Добавлена проверка регистрации: в папке приложения должен быть файл e_init.psw и он должен содержать регистрационный номер ПО. Если такого файла нет или он содержит неверный регистрационный номер, то на экране появится сообщение с телефонами для регистрации и приложение не запустится.


Версия 1.0.0.7
--------------
2017-08-01 Обновлен алгоритм изменения статуса блюд при клике по ЗАГОЛОВКУ ЗАКАЗА: 
 - при выборе нового состояния кликом по заголовку заказа, производится изменение состояния БЛЮД, разрешенных на данном КДСе  вместе с его ингредиентами (или допнаправление печати):
 - если ингредиент имеет разрешенные для этого КДСа цех и статус или блюдо переводится в статус Готово, Выдан или ПодтвОтмены, то при изменении статуса блюда, изменяется и статус этих ингредиентов; иначе изменение статуса родительского блюда не влияет на статус ингредиентов.


Версия 1.0.0.6
--------------
2017-07-24 Изменен алгоритм определения цвета заголовка заказа при условии, что все блюда/ингредиенты, отображаемые на ДАННОМ КДСе, имеют один и тот же статус. Статус заказа автоматически изменяется В БАЗЕ ДАННЫХ, если ВСЕ блюда данного заказа (а не только те, что отображаются на данном КДСе) перешли в один и тот же статус. Сейчас, если элемент "IsShowOrderStatusByAllShownDishes" config-файла имеет значение true (или 1), то заголовок заказа ОТОБРАЖАЕТСЯ тем же статусом (цветом), что и ВСЕ блюда данного цеха.
Лог запросов к БД (KDSDBCommands.log) сейчас пишется в папку Logs приложения.
2017-07-26 Переделан алгоритм отображения и изменения ингредиентов (или доп.направлений печати):
 - если блюдо имеет ингредиенты, то они отображаются после родительского блюда БЕЗ учета их цеха и статуса;
 - если ингредиент имеет разрешенные для этого КДСа цех и статус или блюдо переводится в статус Готово, Выдан или ПодтвОтмены, то при изменении статуса блюда, изменяется и статус этих ингредиентов; иначе изменение статуса родительского блюда не влияет на статус ингредиентов.


Версия 1.0.0.5
--------------
2017-07-18 Продолжается поиск решения проблемы синхронизации состояний блюд/заказов, при которой происходит возврат в предыдущее состояние.
В данной версии добавлена блокировка заказа на службе от изменения по таймеру при запросе от клиента на изменение состояния.
Для одновременного логирования работы службы и клиента в config-файле есть элемент
<add key="SingleClientSvcLog" value="true"/>
Если значение true, то создается файл c:\KDSDBCommands.log, в который будет записываться трассировочная информация от клиента.


Версия 1.0.0.4
--------------
2017-07-14 В заголовке, кроме роли данного КДС, показываются цеха (направления печати), блюда которых будут отображаться на КДСе.
Из заголовка окна удален крестик закрытия окна. При жесте по заголовку окна, оно не меняет своего размера, а только перемещается.


Версия 1.0.0.3
--------------
2017-07-09 Устранен баг "висячих" заголовков заказа.
2017-07-11 При клике по заголовку заказа, сначала выясняется общий статус всех отображаемых на данном КДСе позиций. И, если он есть, т.е. все отображ.позиции имеют одинаковый статус, то возможные переходы определяются по этому статусу.
2017-07-12 Изменен код для корректного отображения заказов в случае двухэтапного перехода в состояние Готов.
Подкорректирован код размещения панелей заказов: исправлен расчет размеров канвы, высоты панели и перенос панели на след.страницу.


Версия 1.0.0.2
--------------
2017-07-03 Если необходимо перенести в другой столбец ингредиент, то он переносится вместе с блюдом.
На панели заказа нумеруются только блюда, ингредиенты НЕ нумеруются.
При инициализации приложения, в лог записывается номер запущенной версии.
Добавлена возможность записи в лог действий пользователя, напр. изменение статуса блюда/заказа (префикс сообщения - userAct).


Версия 1.0.0.1
--------------
2017-06-27 Исправлены ошибки в процедуре группировки заказов по дате создания блюд, что приводило к пропуску обновления экрана в приложении ("зависание" заказов).


Версия 1.0.0.0
--------------
2017-06-22 Исправлен баг неправильной работы сервиса, когда в заказе есть несколько блюд с одинаковыми UID.
В раздел отладки добавлен элемент "TraceOrdersDetails" (логический) - выводить ли в лог подробные сведения о заказах, получаемых от службы.

2017-06-16 Первый запуск у клиента.

2017-06-08 Доработка функционала для отмененных блюд и ингредиентов.
Доработка функционала для группировки по полю CreateDate БЛЮД, а не ЗАКАЗОВ.

2017-06-07 Закончена RC-версия. Начало тестирования на данных, получаемых из 1С.
